<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Tune ecological niche model (ENM) settings and calculate evaluation statistics — ENMevaluate • ENMeval</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tune ecological niche model (ENM) settings and calculate evaluation statistics — ENMevaluate"><meta name="description" content="ENMevaluate() is the primary function for the ENMeval package. This
function builds ecological niche models iteratively across a range of user-specified tuning
settings. Users can choose to evaluate models with cross validation or a full-withheld testing
dataset. ENMevaluate() returns an ENMevaluation object with slots containing
evaluation statistics for each combination of settings and for each cross validation fold therein, as
well as raster predictions for each model when raster data is input. The evaluation statistics in the
results table should aid users in identifying model settings that balance fit and predictive ability. See
the extensive vignette for fully worked examples:
&amp;lt;https://jamiemkass.github.io/ENMeval/articles/ENMeval-2.0-vignette.html&amp;gt;."><meta property="og:description" content="ENMevaluate() is the primary function for the ENMeval package. This
function builds ecological niche models iteratively across a range of user-specified tuning
settings. Users can choose to evaluate models with cross validation or a full-withheld testing
dataset. ENMevaluate() returns an ENMevaluation object with slots containing
evaluation statistics for each combination of settings and for each cross validation fold therein, as
well as raster predictions for each model when raster data is input. The evaluation statistics in the
results table should aid users in identifying model settings that balance fit and predictive ability. See
the extensive vignette for fully worked examples:
&amp;lt;https://jamiemkass.github.io/ENMeval/articles/ENMeval-2.0-vignette.html&amp;gt;."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ENMeval</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ENMeval-2.0-vignette.html">ENMeval 2.0.5 Vignette</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Tune ecological niche model (ENM) settings and calculate evaluation statistics</h1>

      <div class="d-none name"><code>ENMevaluate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>ENMevaluate()</code> is the primary function for the <span class="pkg">ENMeval</span> package. This
function builds ecological niche models iteratively across a range of user-specified tuning
settings. Users can choose to evaluate models with cross validation or a full-withheld testing
dataset. <code>ENMevaluate()</code> returns an <code>ENMevaluation</code> object with slots containing
evaluation statistics for each combination of settings and for each cross validation fold therein, as
well as raster predictions for each model when raster data is input. The evaluation statistics in the
results table should aid users in identifying model settings that balance fit and predictive ability. See
the extensive vignette for fully worked examples:
&lt;https://jamiemkass.github.io/ENMeval/articles/ENMeval-2.0-vignette.html&gt;.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ENMevaluate</span><span class="op">(</span></span>
<span>  <span class="va">occs</span>,</span>
<span>  envs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tune.args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  partitions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  partition.settings <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  other.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  categoricals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  doClamp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  raster.preds <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clamp.directions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  user.enm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  user.grp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  occs.testing <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  taxon.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.bg <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  overlap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overlapStat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"I"</span><span class="op">)</span>,</span>
<span>  user.val.grps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  user.eval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rmm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  numCores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  updateProgress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-occs">occs<a class="anchor" aria-label="anchor" href="#arg-occs"></a></dt>
<dd><p>matrix / data frame: occurrence records with two columns for longitude and latitude
of occurrence localities, in that order. If specifying predictor variable values
assigned to presence/background localities (without inputting raster data), this table should also have
one column for each predictor variable. See Note for important distinctions between running the function
with and without rasters.</p></dd>


<dt id="arg-envs">envs<a class="anchor" aria-label="anchor" href="#arg-envs"></a></dt>
<dd><p>SpatRaster: environmental predictor variables. These should be in same geographic projection as occurrence data.</p></dd>


<dt id="arg-bg">bg<a class="anchor" aria-label="anchor" href="#arg-bg"></a></dt>
<dd><p>matrix / data frame: background records with two columns for longitude and latitude of
background (or pseudo-absence) localities, in that order. If NULL, points will be randomly sampled across <code>envs</code>
with the number specified by argument <code>n.bg</code>. If specifying predictor variable values
assigned to presence/background localities (without inputting raster data), this table should also have
one column for each predictor variable. See Details for important distinctions between running the function
with and without rasters.</p></dd>


<dt id="arg-tune-args">tune.args<a class="anchor" aria-label="anchor" href="#arg-tune-args"></a></dt>
<dd><p>named list: model settings to be tuned (i.e., for Maxent models:  <code>list(fc = c("L","Q"), rm = 1:3)</code>)</p></dd>


<dt id="arg-partitions">partitions<a class="anchor" aria-label="anchor" href="#arg-partitions"></a></dt>
<dd><p>character: name of partitioning technique. Currently available options are
the nonspatial partitions "randomkfold" and "jackknife", the spatial partitions "block" and
"checkerboard", "testing" for partitioning with fully withheld data (see
argument occs.testing), the "user" option (see argument user.grp), and "none" for no partitioning
(see <code><a href="partitions.html">?partitions</a></code> for details).</p></dd>


<dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>character: name of the algorithm used to build models. Currently one of "maxnet",
"maxent.jar", or "bioclim", else the name from a custom ENMdetails implementation.</p></dd>


<dt id="arg-partition-settings">partition.settings<a class="anchor" aria-label="anchor" href="#arg-partition-settings"></a></dt>
<dd><p>named list: used to specify certain settings for partitioning schema.
See Details and ?partitions for descriptions of these settings.</p></dd>


<dt id="arg-other-settings">other.settings<a class="anchor" aria-label="anchor" href="#arg-other-settings"></a></dt>
<dd><p>named list: used to specify extra settings for the analysis.
All of these settings have internal defaults, so if they are not specified the analysis will be run
with default settings. See Details for descriptions of these settings, including how to specify arguments
for maxent.jar.</p></dd>


<dt id="arg-categoricals">categoricals<a class="anchor" aria-label="anchor" href="#arg-categoricals"></a></dt>
<dd><p>character vector: name or names of categorical environmental variables. If not specified,
all predictor variables will be treated as continuous unless they are factors. If categorical variables
are already factors, specifying names of such variables in this argument is not needed.</p></dd>


<dt id="arg-doclamp">doClamp<a class="anchor" aria-label="anchor" href="#arg-doclamp"></a></dt>
<dd><p>boolean: if TRUE (default), model prediction extrapolations will be restricted to the upper and lower
bounds of the predictor variables. Clamping avoids extreme predictions for environment values outside
the range of the training data. If free extrapolation is a study aim, this should be set to FALSE, but
for most applications leaving this at the default of TRUE is advisable to avoid unrealistic predictions.
When predictor variables are input, they are clamped internally before making model predictions when clamping is on.
When no predictor variables are input and data frames of coordinates and variable values are used instead (SWD format),
validation data is clamped before making model predictions when clamping is on.</p></dd>


<dt id="arg-raster-preds">raster.preds<a class="anchor" aria-label="anchor" href="#arg-raster-preds"></a></dt>
<dd><p>boolean: if TRUE (default), return model prediction rasters. If this is FALSE,
the predictions slot in the ENMevaluation object will be empty, which is the same as if no raster
data is input. You can still make model prediction rasters using the model objects in the models slot
with the predict() function.</p></dd>


<dt id="arg-clamp-directions">clamp.directions<a class="anchor" aria-label="anchor" href="#arg-clamp-directions"></a></dt>
<dd><p>named list: specifies the direction ("left" for minimum, "right" for maximum)
of clamping for predictor variables – (e.g., <code>list(left = c("bio1","bio5"), right = c("bio10","bio15"))</code>).</p></dd>


<dt id="arg-user-enm">user.enm<a class="anchor" aria-label="anchor" href="#arg-user-enm"></a></dt>
<dd><p>ENMdetails object: a custom ENMdetails object used to build models.
This is an alternative to specifying <code>algorithm</code> with a character string.</p></dd>


<dt id="arg-user-grp">user.grp<a class="anchor" aria-label="anchor" href="#arg-user-grp"></a></dt>
<dd><p>named list: specifies user-defined partition groups, where <code>occs.grp</code> = vector of partition group
(fold) for each occurrence locality, intended for user-defined partitions, and <code>bg.grp</code> = same vector for
background (or pseudo-absence) localities.</p></dd>


<dt id="arg-occs-testing">occs.testing<a class="anchor" aria-label="anchor" href="#arg-occs-testing"></a></dt>
<dd><p>matrix / data frame: a fully withheld testing dataset with two columns for longitude and latitude
of occurrence localities, in that order when <code>partitions = "testing"</code>. These occurrences will be used only
for evaluation but not for model training, and thus no cross validation will be performed.</p></dd>


<dt id="arg-taxon-name">taxon.name<a class="anchor" aria-label="anchor" href="#arg-taxon-name"></a></dt>
<dd><p>character: name of the focal species or taxon. This is used primarily for annotating
the ENMevaluation object and output metadata (rmm), but not necessary for analysis.</p></dd>


<dt id="arg-n-bg">n.bg<a class="anchor" aria-label="anchor" href="#arg-n-bg"></a></dt>
<dd><p>numeric: the number of background (or pseudo-absence) points to randomly sample over the environmental
raster data (default: 10000) if background records were not already provided.</p></dd>


<dt id="arg-overlap">overlap<a class="anchor" aria-label="anchor" href="#arg-overlap"></a></dt>
<dd><p>boolean: if TRUE, calculate range overlap statistics (Warren <em>et al.</em> 2008).</p></dd>


<dt id="arg-overlapstat">overlapStat<a class="anchor" aria-label="anchor" href="#arg-overlapstat"></a></dt>
<dd><p>character: range overlap statistics to be calculated –
"D" (Schoener's D) and or "I" (Hellinger's I) – see ?calc.niche.overlap for more details.</p></dd>


<dt id="arg-user-val-grps">user.val.grps<a class="anchor" aria-label="anchor" href="#arg-user-val-grps"></a></dt>
<dd><p>matrix / data frame: user-defined validation record coordinates and predictor variable values.
This is used internally by <code><a href="ENMnulls.html">ENMnulls()</a></code> to force each null model to evaluate with empirical validation data,
and does not have any current use when running <code>ENMevaluate()</code> independently.</p></dd>


<dt id="arg-user-eval">user.eval<a class="anchor" aria-label="anchor" href="#arg-user-eval"></a></dt>
<dd><p>function: custom function for specifying performance metrics not included in <span class="pkg">ENMeval</span>.
The function must first be defined and then input as the argument <code>user.eval</code>.
This function should have a single argument called <code>vars</code>, which is a list that includes different data
that can be used to calculate the metric. See Details below and the vignette for a worked example.</p></dd>


<dt id="arg-rmm">rmm<a class="anchor" aria-label="anchor" href="#arg-rmm"></a></dt>
<dd><p>rangeModelMetadata object: if specified, <code>ENMevaluate()</code> will write metadata details for the analysis into
this object, but if not, a new <code>rangeModelMetadata</code> object will be generated and included in the output
<code>ENMevaluation</code> object.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>boolean: if TRUE, run with parallel processing.</p></dd>


<dt id="arg-numcores">numCores<a class="anchor" aria-label="anchor" href="#arg-numcores"></a></dt>
<dd><p>numeric: number of cores to use for parallel processing. If NULL, all available cores will be used.</p></dd>


<dt id="arg-updateprogress">updateProgress<a class="anchor" aria-label="anchor" href="#arg-updateprogress"></a></dt>
<dd><p>boolean: if TRUE, use shiny progress bar. This is only for use in shiny apps.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>boolean: if TRUE, silence all function messages (but not errors).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An ENMevaluation object. See ?ENMevaluation for details and description of the columns
in the results table.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are a few methodological details in the implementation of ENMeval &gt;=2.0.0 that are important to mention.
There is also a brief discussion of some points relevant to null models in ?ENMnulls.</p>
<p>1. By default, validation AUC is calculated with respect to the full background (training + validation).
This approach follows Radosavljevic &amp; Anderson (2014).This setting can be changed by assigning
other.settings$validation.bg to "partition", which will calculate AUC with respect
to the validation background only. The default value for other.settings$validation.bg is "full".
NOTE: When examining validation AUC and other discrimination metrics, the "full" option will likely
result in higher performance than for the "partition" option because more and varied background data
should lead to higher discriminatory power for the model. Users should thus make sure they are correctly
interpreting the evaluation results.</p>
<p>2. The continuous Boyce index (always) and AICc (when no raster is provided) are not calculated using
the predicted values of the SpatRaster delineating the full study extent, but instead using the predicted
values for the background records. This decision to use the background only for calculating the continuous
Boyce index was made to simplify the code and improve running time. The decision for AICc was made in order
to allow AICc calculations for datasets that do not include raster data. See ?calc.aicc for more details,
and for caveats when calculating AICc without raster data (mainly, that if the background does not
adequately represent the occurrence records, users should use the raster approach, for reasons explained
in the calc.aicc documentation). For both metrics, if the background records are a good representation
of the study extent, there should not be much difference between this approach using the background
data and the approach that uses rasters.</p>
<p>3. When running <code>ENMevaluate()</code> without raster data, and instead adding the environmental predictor values
to the occurrence and background data tables, users may notice some differences in the results. Occurrence records
that share a raster grid cell are automatically removed when raster data is provided, but without raster data
this functionality cannot operate, and thus any such duplicate occurrence records can remain in the training data.
The Java implementation of Maxent (maxent.jar implemented with <code>MaxEnt()</code> from the R package <code>predicts</code>) should automatically remove these records, but the R implementation
<code>maxnet</code> does not, and the <code>envelope()</code> function from the R package <code>predicts</code> does not as well. Therefore,
it is up to the user to remove such records before running <code>ENMevaluate()</code> when raster data are not included.</p>
<p>Below are descriptions of the parameters used in the other.settings, partition.settings, and user.eval arguments.</p>
<p>For other.settings, the options are:<br>*
path - character: the folder path designating where maxent.jar files should be saved<br>*
removeduplicates - boolean: whether or not to remove grid-cell duplicates for occurrences
(this controls behavior for maxent.jar and ENMeval)<br>*
addsamplestobackground - boolean: whether or not to add occurrences to the background
when modeling with maxnet – the default is TRUE.<br>*
abs.auc.diff - boolean: if TRUE, take absolute value of AUCdiff (default: TRUE)<br>*
pred.type - character: specifies which prediction type should be used to generate maxnet or
maxent.jar prediction rasters (default: "cloglog").<br>*
validation.bg - character: either "full" to calculate training and validation AUC and CBI
for cross-validation with respect to the full background (default), or "partition" (meant for
spatial partitions only) to calculate each with respect to the partitioned background only
(i.e., training occurrences are compared to training background, and validation occurrences
compared to validation background).<br>*
other.args - named list: any additional model arguments not specified for tuning; this can
include arguments for maxent.jar, which are described in the software's Help file, such as
"jackknife=TRUE" for a variable importance jackknife plot or "responsecurves=TRUE" for response
curve plots – note the the "path" must be specified (see above).<br></p>
<p>For partition.settings, the current options are:<br>*
orientation - character: one of "lat_lon" (default), "lon_lat", "lat_lat", or "lon_lon" (required for block partition).<br>*
aggregation.factor - numeric vector: one or two numbers specifying the factor with which to aggregate the envs (default: 2)
raster to assign partitions (required for the checkerboard partitions).<br>*
kfolds - numeric: the number of folds (i.e., partitions) for random partitions (default: 5).<br></p>
<p>For the block partition, the orientation specifications are abbreviations for "latitude" and "longitude",
and they determine the order and orientations with which the block partitioning function creates the partition groups.
For example, "lat_lon" will split the occurrence localities first by latitude, then by longitude. For the checkerboard
partitions, the aggregation factor specifies how much to aggregate the existing cells in the envs raster
to make new spatial partitions. For example, 'basic' checkerboard with an aggregation factor value of 2 will make squares
4 times larger than the input rasters and assign occurrence and background records to partition groups based on which square they fall in.
Using two aggregation factors makes the checkerboard partitions hierarchical, where squares are first aggregated to define groups as in the 'basic' checkerboard, but a
second aggregation is then made to separate the resulting two bins into four bins (see ?partitions for more details).</p>
<p>For user.eval, the variables you have access to in order to run your custom function are below.
See the vignette for a worked example.<br>*
enm - ENMdetails object<br>*
occs.train.z - data frame: predictor variable values for training occurrences<br>*
occs.val.z - data frame: predictor variable values for validation occurrences<br>*
bg.train.z - data frame: predictor variable values for training background<br>*
bg.val.z - data frame: predictor variable values for validation background<br>*
mod.k - Model object for current partition (k)<br>*
nk - numeric: number of folds (i.e., partitions)<br>*
other.settings - named list: other settings specified in ENMevaluate()<br>*
partitions - character: name of the partition method (e.g., "block")<br>*
occs.train.pred - numeric: predictions made by mod.k for training occurrences<br>*
occs.val.pred - numeric: predictions made by mod.k for validation occurrences<br>*
bg.train.pred - numeric: predictions made by mod.k for training background<br>*
bg.val.pred - numeric: predictions made by mod.k for validation background</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Muscarella, R., Galante, P. J., Soley-Guardia, M., Boria, R. A., Kass, J. M., Uriarte, M., &amp; Anderson, R. P. (2014). ENMeval: An R package for conducting spatially independent evaluations and estimating optimal model complexity for Maxent ecological niche models. <em>Methods in Ecology and Evolution</em>, <b>5</b>: 1198-1205. <a href="https://doi.org/10.1111/2041-210X.12261" class="external-link">doi:10.1111/2041-210X.12261</a></p>
<p>Warren, D. L., Glor, R. E., Turelli, M. &amp; Funk, D. (2008) Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em>, <b>62</b>: 2868-2883. <a href="https://doi.org/10.1111/j.1558-5646.2008.00482.x" class="external-link">doi:10.1111/j.1558-5646.2008.00482.x</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jamiemkass.github.io/ENMeval/">ENMeval</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">occs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"predicts"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span><span class="st">"/ex/bradypus.csv"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">envs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"predicts"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span><span class="st">"/ex"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, pattern<span class="op">=</span><span class="st">"tif$"</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">occs.z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">occs</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">envs</span>, <span class="va">occs</span>, ID <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">occs.z</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">occs.z</span><span class="op">$</span><span class="va">biome</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">predicts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/predicts/man/backgroundSample.html" class="external-link">backgroundSample</a></span><span class="op">(</span><span class="va">envs</span>, n <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bg</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">occs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bg.z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bg</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">envs</span>, <span class="va">bg</span>, ID <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bg.z</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">bg.z</span><span class="op">$</span><span class="va">biome</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set other.settings -- pred.type is only for Maxent models</span></span></span>
<span class="r-in"><span><span class="va">os</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>abs.auc.diff <span class="op">=</span> <span class="cn">FALSE</span>, pred.type <span class="op">=</span> <span class="st">"cloglog"</span>, </span></span>
<span class="r-in"><span>validation.bg <span class="op">=</span> <span class="st">"partition"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># set partition.settings -- here's an example for the block method</span></span></span>
<span class="r-in"><span><span class="co"># see Details for the required settings for other partition methods</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"lat_lat"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># here's a run with maxnet -- note the tune.args for feature classes (fc)</span></span></span>
<span class="r-in"><span><span class="co"># and regularization multipliers (rm), as well as the designation of the</span></span></span>
<span class="r-in"><span><span class="co"># categorical variable we are using (this can be a vector if multiple</span></span></span>
<span class="r-in"><span><span class="co"># categorical variables are used)</span></span></span>
<span class="r-in"><span><span class="va">e.maxnet</span> <span class="op">&lt;-</span> <span class="fu">ENMevaluate</span><span class="op">(</span><span class="va">occs</span>, <span class="va">envs</span>, <span class="va">bg</span>, </span></span>
<span class="r-in"><span>tune.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L"</span>,<span class="st">"LQ"</span>,<span class="st">"LQH"</span>,<span class="st">"H"</span><span class="op">)</span>, rm <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>partitions <span class="op">=</span> <span class="st">"block"</span>, other.settings <span class="op">=</span> <span class="va">os</span>, partition.settings <span class="op">=</span> <span class="va">ps</span>,</span></span>
<span class="r-in"><span>algorithm <span class="op">=</span> <span class="st">"maxnet"</span>, categoricals <span class="op">=</span> <span class="st">"biome"</span>, overlap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print the tuning results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="eval.results.html">eval.results</a></span><span class="op">(</span><span class="va">e.maxnet</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># you can plot the marginal response curves of a maxnet object with plot(), </span></span></span>
<span class="r-in"><span><span class="co"># and you can also extract the data for plotting to make your own custom plots</span></span></span>
<span class="r-in"><span><span class="va">mods.maxnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="eval.models.html">eval.models</a></span><span class="op">(</span><span class="va">e.maxnet</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="va">mods.maxnet</span><span class="op">$</span><span class="va">fc.LQH_rm.2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, type <span class="op">=</span> <span class="st">"cloglog"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rcurve_data</span> <span class="op">&lt;-</span> <span class="fu">maxnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/maxnet/man/plot.maxnet.html" class="external-link">response.plot</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">"bio1"</span>, type <span class="op">=</span> <span class="st">"cloglog"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># there is currently no native function to make raster model predictions for</span></span></span>
<span class="r-in"><span><span class="co"># maxnet models, but ENMeval can be used to make them like this:</span></span></span>
<span class="r-in"><span><span class="co"># here's an example where we make a prediction based on the L2 model</span></span></span>
<span class="r-in"><span><span class="co"># (feature class: Linear, regularization multiplier: 2) for our envs data</span></span></span>
<span class="r-in"><span><span class="va">pred.LQH2</span> <span class="op">&lt;-</span> <span class="fu"><a href="maxnet.predictRaster.html">maxnet.predictRaster</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">envs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.L2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># here's a run with maxent.jar -- note that if the R package rJava cannot </span></span></span>
<span class="r-in"><span><span class="co"># install or load, or if you have other issues with Java on your computer, </span></span></span>
<span class="r-in"><span><span class="co"># maxent.jar will not function</span></span></span>
<span class="r-in"><span><span class="va">e.maxent.jar</span> <span class="op">&lt;-</span> <span class="fu">ENMevaluate</span><span class="op">(</span><span class="va">occs</span>, <span class="va">envs</span>, <span class="va">bg</span>, </span></span>
<span class="r-in"><span>tune.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L"</span>,<span class="st">"LQ"</span>,<span class="st">"LQH"</span>,<span class="st">"H"</span><span class="op">)</span>, rm <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>partitions <span class="op">=</span> <span class="st">"block"</span>, other.settings <span class="op">=</span> <span class="va">os</span>, partition.settings <span class="op">=</span> <span class="va">ps</span>,</span></span>
<span class="r-in"><span>algorithm <span class="op">=</span> <span class="st">"maxent.jar"</span>, categoricals <span class="op">=</span> <span class="st">"biome"</span>, overlap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># here's a run of maxent.jar with a path specified for saving the html and </span></span></span>
<span class="r-in"><span><span class="co"># plot files -- you can also turn on jackknife variable importance or </span></span></span>
<span class="r-in"><span><span class="co"># response curves, etc., to have these plots saved there</span></span></span>
<span class="r-in"><span><span class="va">e.maxent.jar</span> <span class="op">&lt;-</span> <span class="fu">ENMevaluate</span><span class="op">(</span><span class="va">occs</span>, <span class="va">envs</span>, <span class="va">bg</span>, </span></span>
<span class="r-in"><span>tune.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L"</span>,<span class="st">"LQ"</span>,<span class="st">"LQH"</span>,<span class="st">"H"</span><span class="op">)</span>, rm <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>partitions <span class="op">=</span> <span class="st">"block"</span>, partition.settings <span class="op">=</span> <span class="va">ps</span>,</span></span>
<span class="r-in"><span>algorithm <span class="op">=</span> <span class="st">"maxent.jar"</span>, categoricals <span class="op">=</span> <span class="st">"biome"</span>, overlap <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>other.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"analyses/mxnt_results"</span>, </span></span>
<span class="r-in"><span>other.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jackknife=TRUE"</span>, <span class="st">"responsecurves=TRUE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print the tuning results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="eval.results.html">eval.results</a></span><span class="op">(</span><span class="va">e.maxent.jar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># raster predictions can be made for maxent.jar models with predicts or </span></span></span>
<span class="r-in"><span><span class="co"># ENMeval</span></span></span>
<span class="r-in"><span><span class="va">mods.maxent.jar</span> <span class="op">&lt;-</span> <span class="fu"><a href="eval.models.html">eval.models</a></span><span class="op">(</span><span class="va">e.maxent.jar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred.L2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mods.maxent.jar</span><span class="op">$</span><span class="va">fc.L_rm.2</span>, <span class="va">envs</span>, </span></span>
<span class="r-in"><span>args <span class="op">=</span> <span class="st">"outputform=cloglog"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred.L2</span> <span class="op">&lt;-</span> <span class="fu"><a href="maxnet.predictRaster.html">maxnet.predictRaster</a></span><span class="op">(</span><span class="va">mods.maxent.jar</span><span class="op">$</span><span class="va">fc.L_rm.2</span>, <span class="va">envs</span>, <span class="va">os</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.L2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this will give you the percent contribution (not deterministic) and</span></span></span>
<span class="r-in"><span><span class="co"># permutation importance (deterministic) values of variable importance for</span></span></span>
<span class="r-in"><span><span class="co"># Maxent models, and it only works with maxent.jar</span></span></span>
<span class="r-in"><span><span class="fu"><a href="eval.variable.importance.html">eval.variable.importance</a></span><span class="op">(</span><span class="va">e.maxent.jar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># here's a run with BIOCLIM. Note that we need to remove the categorical</span></span></span>
<span class="r-in"><span><span class="co"># variable here because this algorithm only takes continuous variables. We </span></span></span>
<span class="r-in"><span><span class="co"># also should point out that the way BIOCLIM is tuned is by comparing </span></span></span>
<span class="r-in"><span><span class="co"># performance for different ways to make predictions (as opposed to comparing </span></span></span>
<span class="r-in"><span><span class="co"># performance for models fit in different ways like for maxnet or maxent.jar). </span></span></span>
<span class="r-in"><span><span class="co"># Namely, BIOCLIM can ignore different tails of the distribution when making </span></span></span>
<span class="r-in"><span><span class="co"># predictions, and this is what is tuned in ENMevaluate (see </span></span></span>
<span class="r-in"><span><span class="co"># ?predicts::envelope).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print the tuning results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="eval.results.html">eval.results</a></span><span class="op">(</span><span class="va">e.bioclim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># make raster predictions with predicts or ENMeval</span></span></span>
<span class="r-in"><span><span class="va">mods.bioclim</span> <span class="op">&lt;-</span> <span class="fu"><a href="eval.models.html">eval.models</a></span><span class="op">(</span><span class="va">e.bioclim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># note: the models for low, high, and both are actually all the same, and</span></span></span>
<span class="r-in"><span><span class="co"># the only difference for tuning is how they are predicted during</span></span></span>
<span class="r-in"><span><span class="co"># cross-validation</span></span></span>
<span class="r-in"><span><span class="va">pred.both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mods.bioclim</span><span class="op">$</span><span class="va">tails.both</span>, <span class="va">envs</span>, tails <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.both</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># please see the vignette for more examples of model tuning, </span></span></span>
<span class="r-in"><span><span class="co"># partitioning, plotting functions, and null models</span></span></span>
<span class="r-in"><span><span class="co"># https://jamiemkass.github.io/ENMeval/articles/ENMeval-2.0-vignette.html</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jamie M. Kass, Robert Muscarella, Peter J. Galante, Corentin Bohl, Gonzalo E. Buitrago-Pinilla, Robert A. Boria, Mariano Soley-Guardia, Robert P. Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

